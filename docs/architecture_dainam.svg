<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg xmlns="http://www.w3.org/2000/svg" width="1200" height="820" viewBox="0 0 1200 820">
  <defs>
    <linearGradient id="hdr" x1="0" y1="0" x2="1" y2="0">
      <stop offset="0%" stop-color="#2e3192" />
      <stop offset="100%" stop-color="#2e3192" />
    </linearGradient>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="0" dy="2" stdDeviation="6" flood-color="#000" flood-opacity="0.15"/>
    </filter>
    <marker id="arrow" markerWidth="14" markerHeight="10" refX="10" refY="5" orient="auto">
      <polygon points="0 0, 10 5, 0 10" fill="#2e3192" />
    </marker>
    <marker id="arrow2" markerWidth="14" markerHeight="10" refX="10" refY="5" orient="auto">
      <polygon points="0 0, 10 5, 0 10" fill="#f36f21" />
    </marker>
    <style><![CDATA[
      .title { font-family: 'Inter', system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial; font-weight:800; }
      .text  { font-family: 'Inter', system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial; font-weight:600; }
      .small { font-family: 'Inter', system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial; font-weight:500; font-size:14px; fill:#334155; }
    ]]></style>
  </defs>

  <!-- background -->
  <rect x="0" y="0" width="1200" height="820" fill="#f7f9fc" />

  <!-- header -->
  <rect x="0" y="0" width="1200" height="96" fill="url(#hdr)"/>
  <text x="600.0" y="58" text-anchor="middle" fill="#fff" font-size="28" class="title">
    Phát hiện &amp; Highlight ngôn ngữ xúc phạm — Kiến trúc hệ thống
  </text>

  <!-- UI card (left) -->
  <g filter="url(#shadow)">
    <rect x="40" y="140" rx="14" ry="14" width="320" height="220" fill="#ffffff" stroke="#e5e7eb"/>
  </g>
  <rect x="40" y="140" rx="14" ry="14" width="320" height="42" fill="#f36f21"/>
  <text x="200" y="168" text-anchor="middle" fill="#fff" font-size="18" class="title">Trình duyệt (UI)</text>
  <g class="small">
    <text x="60" y="200">• HTML/CSS/JS, Chart.js (doughnut)</text>
    <text x="60" y="224">• Slider ngưỡng &amp; Redact (ẩn ***** )</text>
    <text x="60" y="248">• Hiển thị highlight &lt;mark&gt; theo xác suất</text>
    <text x="60" y="272">• Xuất CSV (client)</text>
  </g>

  <!-- API card (center top) -->
  <g filter="url(#shadow)">
    <rect x="400" y="130" rx="14" ry="14" width="380" height="240" fill="#ffffff" stroke="#e5e7eb"/>
  </g>
  <rect x="400" y="130" rx="14" ry="14" width="380" height="42" fill="#f36f21"/>
  <text x="590" y="158" text-anchor="middle" fill="#fff" font-size="18" class="title">Flask API</text>
  <g class="small">
    <text x="420" y="200">• /api/predict — phân tích 1 đoạn</text>
    <text x="420" y="224">• /api/upload — phân tích file (≤ 200 dòng)</text>
    <text x="420" y="248">• /api/export_docx — xuất DOCX highlight</text>
    <text x="420" y="272">• Trả JSON: spans, probability, HTML highlight</text>
  </g>

  <!-- I/O card (right) -->
  <g filter="url(#shadow)">
    <rect x="820" y="140" rx="14" ry="14" width="340" height="220" fill="#ffffff" stroke="#e5e7eb"/>
  </g>
  <rect x="820" y="140" rx="14" ry="14" width="340" height="42" fill="#f36f21"/>
  <text x="990" y="168" text-anchor="middle" fill="#fff" font-size="18" class="title">I/O &amp; Tệp</text>
  <g class="small">
    <text x="840" y="200">• Nhập: CSV / TXT / XLSX / DOCX / PDF</text>
    <text x="840" y="224">• Tự phát hiện cột văn bản / đoạn</text>
    <text x="840" y="248">• Xuất: DOCX có highlight vàng</text>
    <text x="840" y="272">• data_train.csv (train nhanh, nếu có)</text>
  </g>

  <!-- Pipeline cards (bottom row) -->
  <g filter="url(#shadow)">
    <rect x="70" y="420" rx="14" ry="14" width="250" height="120" fill="#ffffff" stroke="#e5e7eb"/>
    <rect x="360" y="420" rx="14" ry="14" width="260" height="120" fill="#ffffff" stroke="#e5e7eb"/>
    <rect x="650" y="420" rx="14" ry="14" width="260" height="120" fill="#ffffff" stroke="#e5e7eb"/>
    <rect x="940" y="420" rx="14" ry="14" width="220" height="120" fill="#ffffff" stroke="#e5e7eb"/>
  </g>
  <text x="195" y="448" text-anchor="middle" fill="#2e3192" font-size="16" class="title">Chuẩn hoá &amp; Tiền xử lý</text>
  <g class="small">
    <text x="90" y="474">• Hạ chữ, loại khoảng trắng</text>
    <text x="90" y="494">• Thay viết tắt: dm, đm, vcl…</text>
    <text x="90" y="514">• Tạo văn bản chuẩn hoá</text>
  </g>

  <text x="490" y="448" text-anchor="middle" fill="#2e3192" font-size="16" class="title">TF‑IDF + Logistic</text>
  <g class="small">
    <text x="380" y="474">• TF‑IDF 1–2 gram</text>
    <text x="380" y="494">• Dự đoán xác suất xúc phạm</text>
    <text x="380" y="514">• Rút top‑k từ đóng góp dương</text>
  </g>

  <text x="780" y="448" text-anchor="middle" fill="#2e3192" font-size="16" class="title">Lexicon &amp; Viết tắt</text>
  <g class="small">
    <text x="670" y="474">• Khớp từ/cụm qua regex biên từ</text>
    <text x="670" y="494">• Map viết tắt → nghĩa thô tục</text>
    <text x="670" y="514">• Sinh các span ứng viên</text>
  </g>

  <text x="1050" y="448" text-anchor="middle" fill="#2e3192" font-size="16" class="title">Gộp span &amp; Highlight</text>
  <g class="small">
    <text x="960" y="474">• Gộp chồng lấn &amp; sắp xếp</text>
    <text x="960" y="494">• Sinh HTML &lt;mark&gt; + tooltip nguồn</text>
    <text x="960" y="514">• Kết luận cuối &amp; trả JSON</text>
  </g>

  <!-- Arrows for flow -->
  <line x1="360" y1="250" x2="400" y2="250" stroke="#2e3192" stroke-width="3" marker-end="url(#arrow)" />
  <line x1="780" y1="250" x2="820" y2="250" stroke="#2e3192" stroke-width="3" marker-end="url(#arrow)" />

  <line x1="195" y1="380" x2="195" y2="420" stroke="#f36f21" stroke-width="3" marker-end="url(#arrow2)" />
  <line x1="320" y1="480" x2="360" y2="480" stroke="#f36f21" stroke-width="3" marker-end="url(#arrow2)" />
  <line x1="620" y1="480" x2="650" y2="480" stroke="#f36f21" stroke-width="3" marker-end="url(#arrow2)" />
  <line x1="910" y1="480" x2="940" y2="480" stroke="#f36f21" stroke-width="3" marker-end="url(#arrow2)" />

  <!-- Legend -->
  <g>
    <rect x="40" y="570" rx="10" ry="10" width="380" height="90" fill="#ffffff" stroke="#e5e7eb" filter="url(#shadow)"/>
    <text x="60" y="596" class="title" font-size="16" fill="#2e3192">Chú thích</text>
    <g class="small">
      <rect x="60" y="610" width="14" height="14" fill="#2e3192" rx="3" ry="3"/>
      <text x="80" y="622">Luồng dữ liệu/API</text>
      <rect x="220" y="610" width="14" height="14" fill="#f36f21" rx="3" ry="3"/>
      <text x="240" y="622">Luồng xử lý nội bộ</text>
    </g>
  </g>

  <!-- Footer -->
  <text x="600.0" y="800" text-anchor="middle" class="small" fill="#334155">
    Palette: Cam #f36f21 • Xanh #2e3192 • Nền #f7f9fc
  </text>
</svg>
